#! /bin/bash

set -eu

# 查找sshd使用的liblzma路径
path="$(ldd $(which sshd) | grep liblzma | grep -o '/[^ ]*')"

# 判断路径是否存在
if [ "$path" == "" ]; then
  echo "可能不容易受到攻击"
  exit
fi

# 检查函数签名
if hexdump -ve '1/1 "%.2x"' "$path" | grep -q f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410; then
  echo "可能容易受到攻击"
else
  echo "可能不容易受到攻击"
fi
